
{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Publicaci√≥n servicio</title>
  <link rel="icon" href="{% static 'images/logoICONO.ico' %}" type="image/x-icon">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Archivo CSS personalizado -->
  <link rel="stylesheet" type="text/css" href="{% static 'css/publicacion_servicio.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'css/globales.css' %}">

  <!-- Fuentes de Google -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
  <!-- Barra de navegaci√≥n -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
      <a class="navbar-brand" href="{% url 'index' %}"><img class=logo src="{% static 'images/logoDR.png' %}" alt="Logo"
          width="100" height="auto"></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-left">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="{% url 'index' %}">Inicio</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="{% url 'servicios_sin_login' %}">Servicios</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="{% url 'acerca_de' %}">Acerca de</a>
          </li>
        </ul>
        <ul class="navbar-nav ms-auto">
          {% if user.is_authenticated %}
          <li class="nav-item">
            <a class="nav-link active" href="{% url 'cerrar_sesion' %}">Cerrar sesi√≥n</a>
          </li>
          {% else %}
          <li class="nav-item">
            <a class="nav-link active" href="{% url 'inicio_sesion' %}">Iniciar sesi√≥n</a>
          </li>
          <li class="nav-item">
            <a href="{% url 'registro_cliente' %}" class="btn btn-primary">√önete</a>
          </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </nav>

  <div class="container">
    <div class="row">

     <div class="container mt-5">
    <div class="row align-items-center">
        <!-- Columna de Informaci√≥n -->
        <div class="col-md-6">
            <div class="service-header">
                <h1>{{ servicio.nombre }}</h1>
                <div class="rating">
                    {% for i in "12345" %}
                    {% if forloop.counter <= servicio.promedio_calificacion %}
                    <span class="estrella">‚òÖ</span>
                    {% else %}
                    <span class="estrella">‚òÜ</span>
                    {% endif %}
                    {% endfor %}
                    <span> {{ servicio.promedio_calificacion }} </span>
                    <a href="#"> Ver Rese√±as</a>
                </div>
            </div>

            <div class="company-details">
                <h2>{{ servicio.proveedor.nombre_empresa }}</h2>
                <p>Desde ${{ servicio.precio_minimo }}</p>
            </div>

            <div class="buttons mt-3">
                {% if user.is_authenticated %}
                {% if user.es_cliente %}
                <button class="quote-btn" data-bs-toggle="modal" data-bs-target="#requestQuoteModal">Solicitar
                    presupuesto</button>
                {% else %}
                <button class="quote-btn not-client">Solicitar presupuesto</button>
                {% endif %}
                {% else %}
                <a href="{% url 'registro_cliente' %}" class="quote-btn" style="text-decoration: none;">Solicitar
                    presupuesto</a>
                {% endif %}
            </div>

            <div class="contact-info">
                <p><strong>Contacto de la empresa</strong></p>
                <p>üìß <a href="mailto:{{ servicio.proveedor.user.email }}">{{ servicio.proveedor.user.email }}</a></p>
            </div>
        </div>

        <!-- Columna de la Imagen -->
        <div class="col-md-6">
            <div id="carouselServicio" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner">
                    {% for imagen in servicio.imagenes.all %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                        <img src="{{ imagen.imagen.url }}" 
                             class="d-block w-100" 
                             alt="{{ servicio.nombre }}" 
                             style="width: 100%; height: 300px; object-fit: contain; object-position: center; border-radius: 10px;">
                    </div>
                    {% endfor %}
                </div>
                <!-- Botones de navegaci√≥n con estilo -->
                <button class="carousel-control-prev custom-carousel-btn" type="button" data-bs-target="#carouselServicio" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Anterior</span>
                </button>
                <button class="carousel-control-next custom-carousel-btn" type="button" data-bs-target="#carouselServicio" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Siguiente</span>
                </button>
            </div>
        </div>
    </div>
</div>


  <!-- Description Section -->
  <div class="container">
    <div class="description">
      <h2>Descripci√≥n del servicio</h2>
      <p>{{ servicio.informacion_detallada | linebreaksbr }}</p>
    </div>
  </div>

  <div class="container">
    <h2>Ubicaci√≥n</h2>
    <div class="map-container">

      <iframe id="googleMapIframe" width="1000" height="600" style="border:0" loading="lazy" allowfullscreen
        referrerpolicy="no-referrer-when-downgrade"
        src="https://www.google.com/maps/embed/v1/place?key=AIzaSyBHurZ4KsBAxkPEwveGc2-odDwscEXUsvY&q={{ servicio.direccion }}">
      </iframe>

    </div>
  </div>

 <!-- Rese√±as -->
<div class="reviews-container">
    {% for rese√±a in rese√±as %}
        <div class="review-card">
          <!-- Limitar el nombre del cliente a una l√≠nea -->
          <p class="review-client">{{ rese√±a.usuario.email }}</p> 
          <p class="review-date">{{ rese√±a.fecha|date:"d/m/Y" }}</p>

          <!-- Calificaci√≥n con estrellas centradas y el formato X/5 -->
          <div class="rating">
            {% for i in "12345" %}
                {% if forloop.counter <= rese√±a.calificacion %}
                    <span class="estrella full">‚òÖ</span>
                {% else %}
                    <span class="estrella">‚òÜ</span>
                {% endif %}
            {% endfor %}
            <span class="rating-value">{{ rese√±a.calificacion }}/5</span>
          </div>
          
          <p class="review-text">{{ rese√±a.comentario }}</p>
        </div>
    {% empty %}
        <p>No hay rese√±as disponibles.</p>
    {% endfor %}
</div>


  {% if servicio.proveedor == user.proveedor %}
  <!-- Nuevos botones de Editar y Eliminar publicaci√≥n alineados a la derecha -->
  <div class="container d-flex justify-content-end mt-4">
    <button class="btn btn-warning me-2" data-bs-toggle="modal" data-bs-target="#editPostModal">Editar
      publicaci√≥n</button>
    <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deletePostModal">Eliminar
      publicaci√≥n</button>
  </div>
  {% endif %}
 
  <!-- Pie de p√°gina -->
<footer>
  <div class="container text-center">
      <p>&copy; 2024 DecoRent. Todos los derechos reservados.</p>
      <ul class="list-inline">
          <li class="list-inline-item"><a href="#" data-bs-toggle="modal" data-bs-target="#terminosModal">T√©rminos de Servicio</a></li>
          <li class="list-inline-item"><a href="#" data-bs-toggle="modal" data-bs-target="#privacidadModal">Pol√≠tica de Privacidad</a></li>
          <li class="list-inline-item"><a href="#" data-bs-toggle="modal" data-bs-target="#contactoModal">Contacto</a></li>
      </ul>
  </div>
</footer>
   <!-- Modales -->
  <!-- T√©rminos de Servicio Modal -->
  <div class="modal fade" id="terminosModal" tabindex="-1" aria-labelledby="terminosModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="terminosModalLabel">T√©rminos de Servicio</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>
            Bienvenido a DecoRent, la plataforma en l√≠nea dedicada a la renta de servicios para eventos especiales. Al acceder o utilizar nuestro sitio web y servicios, aceptas cumplir con estos T√©rminos de Servicio. Por favor, l√©elos cuidadosamente antes de proceder.<br><br>
            1. Aceptaci√≥n de los T√©rminos<br>
            Al registrarte y utilizar DecoRent, aceptas estos T√©rminos de Servicio en su totalidad. Nos reservamos el derecho de modificar o actualizar estos t√©rminos en cualquier momento. Cualquier cambio entrar√° en vigor una vez publicado en nuestro sitio, y al continuar usando los servicios, aceptas estos cambios.<br><br>
            2. Uso Permitido<br>
            DecoRent est√° destinado a usuarios que buscan organizar eventos mediante la renta de servicios. Los usuarios deben actuar de buena fe y proporcionar informaci√≥n precisa en sus reservas. Queda prohibido el uso de la plataforma para cualquier actividad que infrinja la ley o que vaya en contra de los intereses de DecoRent o sus usuarios.<br><br>
            3. Registro de Usuarios y Seguridad<br>
            Al registrarte en DecoRent, eres responsable de mantener la confidencialidad de tus datos de acceso. Eres responsable de todas las actividades realizadas bajo tu cuenta. DecoRent no se hace responsable de cualquier acceso no autorizado a tu cuenta si no tomaste las medidas adecuadas para proteger tu informaci√≥n.<br><br>
            4. Servicios de Terceros<br>
            DecoRent act√∫a como intermediario para conectar a clientes con proveedores de servicios para eventos. No garantizamos la disponibilidad ni la calidad de los servicios prestados por terceros. Los proveedores de servicios son responsables de cumplir con los compromisos acordados. En caso de problemas o reclamaciones sobre el servicio, DecoRent ofrecer√° asistencia para facilitar la resoluci√≥n.<br><br>
            5. Pol√≠tica de Reservas y Pagos<br>
            Los usuarios pueden realizar reservas de servicios de manera anticipada. Los precios, t√©rminos de pago y pol√≠ticas de cancelaci√≥n estar√°n especificados en el momento de la reserva. Es importante que el usuario revise todos los detalles antes de confirmar cualquier transacci√≥n.<br><br>
            6. Limitaci√≥n de Responsabilidad<br>
            DecoRent no ser√° responsable por da√±os directos, indirectos, incidentales o consecuentes que puedan surgir del uso de nuestra plataforma o de los servicios ofrecidos. DecoRent no se hace responsable por incumplimientos o da√±os derivados de los servicios prestados por proveedores externos.<br><br>
            7. Propiedad Intelectual<br>
            Todos los materiales, contenido y dise√±o del sitio son propiedad de DecoRent y est√°n protegidos por derechos de autor. Queda prohibida su reproducci√≥n, distribuci√≥n o modificaci√≥n sin el consentimiento expreso de DecoRent.<br><br>
            8. Modificaciones a los T√©rminos<br>
            DecoRent se reserva el derecho de actualizar o modificar estos T√©rminos de Servicio en cualquier momento. Las actualizaciones se publicar√°n en nuestro sitio web y recomendamos a los usuarios revisar regularmente esta p√°gina para mantenerse informados.<br><br>
            9. Contacto<br>
            Si tienes preguntas o comentarios sobre estos T√©rminos de Servicio, no dudes en contactarnos a trav√©s de nuestra p√°gina de contacto o enviando un correo a contacto@decorent.com. Estaremos encantados de atenderte y resolver cualquier duda.<br><br>
            Al aceptar estos T√©rminos de Servicio, declaras que has le√≠do, comprendido y est√°s de acuerdo con todas las condiciones aqu√≠ expuestas. Gracias por elegir DecoRent. Nos esforzamos en ofrecer una experiencia excepcional para que tus eventos sean memorables y exitosos.
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Pol√≠tica de Privacidad Modal -->
  <div class="modal fade" id="privacidadModal" tabindex="-1" aria-labelledby="privacidadModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="privacidadModalLabel">Pol√≠tica de Privacidad</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>
            En DecoRent, respetamos tu privacidad y nos comprometemos a proteger los datos personales que nos compartes. Esta Pol√≠tica de Privacidad describe c√≥mo recopilamos, utilizamos y protegemos tu informaci√≥n, y tus derechos en relaci√≥n con ella.<br><br>
            1. Informaci√≥n que Recopilamos<br>
            Para proporcionarte nuestros servicios, podemos recopilar informaci√≥n personal como tu nombre, direcci√≥n de correo electr√≥nico, n√∫mero de tel√©fono y detalles espec√≠ficos del evento que deseas organizar. Estos datos son necesarios para gestionar tus reservas y ofrecerte una experiencia personalizada.<br><br>
            2. Uso de la Informaci√≥n<br>
            La informaci√≥n personal que recopilamos se utiliza para procesar tus solicitudes de reserva, coordinar servicios con los proveedores, y mejorar nuestra plataforma para ofrecerte una experiencia √≥ptima. Tambi√©n podemos utilizar tu informaci√≥n para enviarte comunicaciones importantes sobre tu reserva o notificaciones sobre actualizaciones relevantes de nuestros servicios.<br><br>
            3. Protecci√≥n de Datos<br>
            Empleamos medidas de seguridad f√≠sicas y electr√≥nicas avanzadas para proteger tu informaci√≥n personal contra el acceso no autorizado, p√©rdida o alteraci√≥n. Solo el personal autorizado de DecoRent y nuestros proveedores de servicios tienen acceso a estos datos, siempre bajo estrictas condiciones de confidencialidad.<br><br>
            4. Compartici√≥n de Informaci√≥n con Terceros<br>
            Compartimos tus datos personales √∫nicamente con proveedores de servicios seleccionados, cuando es necesario para llevar a cabo el servicio contratado (por ejemplo, para coordinar la entrega de un servicio en la fecha de tu evento). Nos aseguramos de que estos proveedores cumplan con altos est√°ndares de confidencialidad y seguridad.<br><br>
            5. Cookies y Tecnolog√≠as Similares<br>
            DecoRent puede utilizar cookies y tecnolog√≠as similares para mejorar la experiencia de usuario en nuestro sitio web. Estas herramientas nos permiten recordar tus preferencias y realizar un seguimiento de la navegaci√≥n para optimizar el rendimiento de nuestra plataforma.<br><br>
            6. Tus Derechos<br>
            Tienes derecho a acceder, rectificar o eliminar tus datos personales en cualquier momento. Si deseas actualizar tu informaci√≥n o tienes dudas sobre c√≥mo gestionamos tus datos, puedes contactarnos y te asistiremos en todo momento.<br><br>
            7. Modificaciones a esta Pol√≠tica<br>
            DecoRent puede actualizar esta Pol√≠tica de Privacidad para reflejar cambios en nuestras pr√°cticas o por razones legales. Te notificaremos de cualquier cambio publicando la versi√≥n actualizada en esta p√°gina.<br><br>
            Gracias por confiar en DecoRent para la organizaci√≥n de tus eventos. Estamos comprometidos a proteger tu privacidad y a proporcionarte una experiencia segura y de calidad.
          </p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Contacto Modal -->
  <div class="modal fade" id="contactoModal" tabindex="-1" aria-labelledby="contactoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="contactoModalLabel">Contacto</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>
            Estamos aqu√≠ para ayudarte. Puedes ponerte en contacto con nosotros a trav√©s del formulario a continuaci√≥n o utilizar los siguientes datos:<br><br>
            <strong>Correo Electr√≥nico:</strong> contacto@decorent.com<br>
            <strong>Tel√©fono:</strong> +52 (123) 456-7890<br>
            <strong>Direcci√≥n:</strong> Calle Principal 123, Ciudad Ju√°rez, Chihuahua, M√©xico<br><br>
            Nuestro equipo est√° disponible de lunes a viernes de 9:00 a.m. a 6:00 p.m., y los s√°bados de 10:00 a.m. a 2:00 p.m.
          </p>
          <hr>
          <form>
            <div class="mb-3">
              <label for="nombre" class="form-label">Nombre</label>
              <input type="text" class="form-control" id="nombre" required>
            </div>
            <div class="mb-3">
              <label for="correo" class="form-label">Correo Electr√≥nico</label>
              <input type="email" class="form-control" id="correo" required>
            </div>
            <div class="mb-3">
              <label for="mensaje" class="form-label">Mensaje</label>
              <textarea class="form-control" id="mensaje" rows="3" required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Enviar</button>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal para Editar publicaci√≥n con imagen -->
  <div class="modal fade" id="editPostModal" tabindex="-1" aria-labelledby="editPostModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editPostModalLabel">Editar publicaci√≥n</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form enctype="multipart/form-data" method="POST" action="{% url 'editar_servicio' servicio.id %}">
            {% csrf_token %}



            <div class="row mb-3">
              <div class="col-md-6">
                <label for="nombre" class="form-label">Nombre del servicio:</label>
                <input type="text" class="form-control" id="nombre" name="nombre" value="{{ servicio.nombre }}"
                  required>
              </div>
              <div class="col-md-6">
                <label for="categoria" class="form-label">Tipo de servicio:</label>
                <select class="form-select" id="categoria" name="categoria" required>
                  <option value="Entretenimiento" {% if servicio.categoria == "Entretenimiento" %}selected{% endif %}>Entretenmiento</option>
                  <option value="Equipamiento_Mobiliario" {% if servicio.categoria == "Equipamiento_Mobiliario"%}selected{% endif %}>Equipamiento y mobiliario</option>
                  <option value="Espacios_Eventos" {% if servicio.categoria == "Espacios_Eventos" %}selected{% endif %}>Espacios para eventos</option>
                  <option value="Catering" {% if servicio.categoria == "Catering" %}selected{% endif %}>Catering</option>
                  <option value="Fotografia" {% if servicio.categoria == "Fotografia" %}selected{% endif %}>Fotograf√≠a</option>
                  <option value="Decoracion" {% if servicio.categoria == "Decoracion" %}selected{% endif %}>Decoraci√≥n</option>
                  <option value="Otro" {% if servicio.categoria == "Otro" %}selected{% endif %}>Otro</option>
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="calle" class="form-label">Calle:</label>
                <input type="text" class="form-control" id="calle" name="calle" value="{{ direccion.calle }}" required>
              </div>
              <div class="col-md-3">
                <label for="numero_exterior" class="form-label">N√∫mero exterior:</label>
                <input type="text" class="form-control" id="numero_exterior" name="numero_exterior"
                  value="{{ direccion.numero_exterior }}" required>
              </div>
              <div class="col-md-3">
                <label for="numero_interior" class="form-label">N√∫mero interior:</label>
                <input type="text" class="form-control" id="numero_interior" name="numero_interior"
                  value="{{ direccion.numero_interior }}">
              </div>
              <div class="col-md-3">
                <label for="colonia" class="form-label">Colonia:</label>
                <input type="text" class="form-control" id="colonia" name="colonia" value="{{ direccion.colonia }}"
                  required>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="codigo_postal" class="form-label">C√≥digo Postal:</label>
                <input type="text" class="form-control" id="codigo_postal" name="codigo_postal"
                  value="{{ direccion.codigo_postal }}" required>
              </div>
              <div class="col-md-3">
                <label for="precio_minimo" class="form-label">Precio m√≠nimo:</label>
                <input type="number" class="form-control" id="precio_minimo" name="precio_minimo"
                  value="{{ servicio.precio_minimo }}" required>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-12">
                <label for="informacion_detallada" class="form-label">Informaci√≥n detallada:</label>
                <textarea class="form-control" id="informacion_detallada" name="informacion_detallada" rows="3"
                  required>{{ servicio.informacion_detallada }}</textarea>
              </div>
            </div>



            <!-- Campo para agregar la imagen -->
            <div class="row mb-3">
              <div class="col-md-12">
                <label for="serviceImage" class="form-label">Imagen del servicio:</label>
                <input type="file" class="form-control" id="serviceImage" name="serviceImage" accept="image/*" multiple>
              </div>
            </div>
            <!-- Mostrar la imagen actual del servicio antes del campo de selecci√≥n de archivo -->
            <div class="mb-3 text-center">
              <label for="currentImagePreview" class="form-label d-block">Imagen actual del servicio:</label>
              <img id="currentImagePreview" src="{{ servicio.imagenes.first.imagen.url }}" class="img-fluid mb-3"
                style="max-width: 200px; max-height: 200px; object-fit: cover; border-radius: 8px;">
            </div>
            <div class="d-flex justify-content-end">
              <button type="submit" class="btn btn-primary me-2">Actualizar</button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            </div>

          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para eliminar publicaci√≥n -->
  <div class="modal fade" id="deletePostModal" tabindex="-1" aria-labelledby="deletePostModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deletePostModalLabel">Confirmar eliminaci√≥n</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>¬øEst√° seguro de que desea eliminar este servicio?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
          <form method="POST" action="{% url 'eliminar_publicacion' servicio.id %}">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger">S√≠, eliminar</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal para solicitar presupuesto -->
  <div class="modal fade" id="requestQuoteModal" tabindex="-1" aria-labelledby="requestQuoteModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="requestQuoteModalLabel">Solicitud de servicio</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <h3>{{ servicio.nombre }}</h3>
          <p> {{ servicio.proveedor.nombre_empresa }} </p>
          <h5>Ingresa la informaci√≥n de tu evento:</h5>
          <form id="solicitudPresupuestoForm" method="post" action="{% url 'solicitar_presupuesto' servicio.id %}">
            {% csrf_token %}
            <div class="row mb-3">
              <div class="col-md-3">
                <label for="id_personas" class="form-label">Cantidad de invitados:</label>
                <input type="number" name="personas" class="form-control" id="id_personas" required>
              </div>
              <div class="col-md-3">
                <label for="id_duracion" class="form-label">Duraci√≥n del evento (horas):</label>
                <input type="number" name="duracion" class="form-control" step="any" id="id_duracion" required>
              </div>
              <div class="col-md-3">
                <label for="id_fecha" class="form-label">Fecha:</label>
                <input type="date" name="fecha" class="form-control" id="id_fecha" required>
              </div>
              <div class="col-md-3">
                <label for="id_tipo_evento" class="form-label">Tipo de evento:</label>
                <select name="tipo_evento" class="form-select" maxlength="100" id="id_tipo_evento" required>
                  <option value="Cumplea√±os">Cumplea√±os</option>
                  <option value="Quincea√±era">Quincea√±era</option>
                  <option value="Boda">Boda</option>
                  <option value="Aniversario">Aniversario</option>
                  <option value="Graduaci√≥n">Graduaci√≥n</option>
                  <option value="Reuni√≥n">Reuni√≥n</option>
                  <option value="Corporativo">Corporativo</option>
                  <option value="Otro">Otro</option>
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label for="id_calle" class="form-label">Calle:</label>
                <input type="text" name="calle" class="form-control" maxlength="255" id="id_calle" required>
              </div>
              <div class="col-md-3">
                <label for="id_numero_exterior" class="form-label">N√∫mero exterior:</label>
                <input type="text" name="numero_exterior" class="form-control" maxlength="10" id="id_numero_exterior"
                  required>
              </div>
              <div class="col-md-3">
                <label for="id_numero_interior" class="form-label">N√∫mero interior:</label>
                <input type="text" name="numero_interior" class="form-control" maxlength="10" id="id_numero_interior">
              </div>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label for="id_colonia" class="form-label">Colonia:</label>
                <input type="text" name="colonia" class="form-control" maxlength="255" id="id_colonia" required>
              </div>
              <div class="col-md-6">
                <label for="id_codigo_postal" class="form-label">C√≥digo Postal:</label>
                <input type="text" name="codigo_postal" class="form-control" maxlength="10" id="id_codigo_postal"
                  required>
              </div>
              <div class="d-flex justify-content-end"> <!-- Alineaci√≥n a la derecha usando Flexbox -->
                <button type="submit" id="submitSolicitud" class="btn btn-primary me-2">Enviar</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
              </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://kit.fontawesome.com/a076d05399.js"></script> <!-- Para usar las flechas -->

  <script>
    // Manejo de la solicitud de presupuesto
    document.getElementById('submitSolicitud').addEventListener('click', function (event) {
      event.preventDefault();

      // Obtener el formulario
      const form = document.getElementById('solicitudPresupuestoForm');
      const formData = new FormData(form);

      // Enviar la solicitud AJAX
      fetch(form.action, {
        method: 'POST',
        body: formData,
        headers: {
          'X-Requested-With': 'XMLHttpRequest',
        },
      })
        .then(response => response.json())
        .then(data => {
          if (data.status === 'success') {
            alert(data.message);
            const modal = bootstrap.Modal.getInstance(document.getElementById('requestQuoteModal'));
            modal.hide();
          } else {
            let errors = '';
            for (const [field, messages] of Object.entries(data.errors)) {
              errors += `${field}: ${messages.join(', ')}\n`;
            }
            alert('Errores en el formulario:\n' + errors);
          }
        })
        .catch(error => console.error('Error:', error));
    });

    // Mensaje para usuarios proveedores al hacer clic en "Solicitar presupuesto"
    document.addEventListener('DOMContentLoaded', function () {
      const notClientButton = document.querySelector('.not-client');
      if (notClientButton) {
        notClientButton.addEventListener('click', function (event) {
          event.preventDefault();
          alert("Solo los clientes pueden realizar una solicitud de presupuesto. Por favor, crea una cuenta como cliente.");
        });
      }
    });
    // Manejo de la edici√≥n del servicio
    document.querySelector("#editPostModal form").addEventListener("submit", function (event) {
      event.preventDefault();
      const form = event.target;
      const formData = new FormData(form);

      fetch(form.action, {
        method: "POST",
        body: formData,
      })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            const modal = bootstrap.Modal.getInstance(document.getElementById("editPostModal"));
            modal.hide();

            // Construye la nueva direcci√≥n usando los datos del formulario
            const calle = document.getElementById("calle").value;
            const numero_exterior = document.getElementById("numero_exterior").value;
            const colonia = document.getElementById("colonia").value;
            const codigo_postal = document.getElementById("codigo_postal").value;

            const nuevaDireccion = `${calle} ${numero_exterior}, ${colonia}, ${codigo_postal} Ciudad Ju√°rez, Chihuahua`;

            // Codifica la direcci√≥n para URL
            const direccionCodificada = encodeURIComponent(nuevaDireccion);

            // Actualiza el src del iframe de Google Maps con la nueva direcci√≥n
            const googleMapIframe = document.getElementById("googleMapIframe");
            if (googleMapIframe) {
              googleMapIframe.src = `https://www.google.com/maps/embed/v1/place?key=AIzaSyBHurZ4KsBAxkPEwveGc2-odDwscEXUsvY&q=${direccionCodificada}`;
            } else {
              console.error("No se encontr√≥ el iframe de Google Maps con el ID 'googleMapIframe'.");
            }

            // Recarga la p√°gina despu√©s de actualizar el iframe de Google Maps
            setTimeout(() => {
              window.location.reload(); // Recarga la p√°gina para reflejar los cambios
            }, 500); // Espera medio segundo para asegurar el cierre del modal y la actualizaci√≥n del iframe
          } else {
            let errorMsg = "Error al actualizar el servicio.";
            if (data.errors) {
              errorMsg += "\nDetalles del error:\n";
              for (const [field, messages] of Object.entries(data.errors)) {
                errorMsg += `${field}: ${messages.join(", ")}\n`;
              }
            }
            alert(errorMsg);
          }
        })
        .catch(error => {
          console.error("Error en la solicitud:", error);
          alert("Error en la solicitud: " + error.message);
        });
    });

  </script>

</body>

</html>